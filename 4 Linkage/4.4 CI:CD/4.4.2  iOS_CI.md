### Ô£ø CI Guide –ø–æ —ç—Ç–∞–ø–∞–º —Å–±–æ—Ä–∫–∏ iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –∞–≥–µ–Ω—Ç–µ Jenkins

![CI_stages](https://github.com/eldaroid/pictures/blob/master/iOSWiki/Frameworks/CI_stages.jpeg?raw=true)

<details>
<summary><strong>1) –°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</strong></summary>
<p>

    –ù–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è —Å–±–æ—Ä–æ–∫ iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω–æ —Ç–∞–∫ –∏ –¥–ª—è jenkins

   <details>
   <summary><strong>1.1) –î–∞—Ç–∞/–í—Ä–µ–º—è/–ú–µ—Å—Ç–æ/–ö–∞–ª–µ–Ω–¥–∞—Ä—å</strong></summary>
   <p>

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ —Ç–µ–∫—É—â–µ–π (–ü—Ä–∏–º–µ—Ä: 14 –¥–µ–∫–∞–±—Ä—è 2024 –≥–æ–¥–∞, 15:30:00):

`sudo date 121415302024`

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ú–µ—Å—Ç–∞ –∏ –ö–∞–ª–µ–Ω–¥–∞—Ä—è:

`sudo systemsetup --settimezone Europe/Moscow`

   </p>
   </details>

   <details>
   <summary><strong>1.2) –°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</strong></summary>
   <p>

‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Üí –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ ‚Üí  –¢–µ—Ä–º–∏–Ω–∞–ª –∏ iTerm2 ‚úîÔ∏è

‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Üí –î–æ—Å—Ç—É–ø –∫ –¥–∏—Å–∫—É ‚Üí –¢–µ—Ä–º–∏–Ω–∞–ª –∏ iTerm2 ‚úîÔ∏è

‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Üí –°–ª—É–∂–±—ã –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏

* –†–∞–∑—Ä–µ—à–∏—Ç—å —ç—Ç–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º –∏ —Å–ª—É–∂–±–∞–º –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –í–∞—à—É –≥–µ–æ–ø–æ–∑–∏—Ü–∏—é - –í–∫–ª
* Workspace ONE Intelligent Hub - –í–∫–ª

‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Üí –ü–æ–¥—Ä–æ–±–Ω–µ–µ –∏ —Ç—É—Ç —É–±—Ä–∞—Ç—å –≤—Å–µ –≥–∞–ª–∫–∏

‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –≠–∫–æ–Ω–æ–º–∏—è —ç–Ω–µ—Ä–≥–∏–∏ ‚Üí –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–±–æ–µ –ø–∏—Ç–∞–Ω–∏—è ‚úîÔ∏è

‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ ‚Üí "–ß–∞—Å—Ç–æ—Ç–∞ –∞–≤—Ç–æ–ø–æ–≤—Ç–æ—Ä–∞ –∫–ª–∞–≤–∏—à–∏" –∏ "–ó–∞–¥–µ—Ä–∂–∫–∞ –¥–æ –Ω–∞—á–∞–ª–∞ –∞–≤—Ç–æ–ø–æ–≤—Ç–æ—Ä–∞" –Ω–∞ –º–∞–∫—Å–∏–º—É–º –ø–æ —à–∫–∞–ª–µ "–ë—ã—Å—Ç—Ä–æ"

‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –≠–∫—Ä–∞–Ω –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ ‚Üí "–í–∫–ª—é—á–∞—Ç—å –∑–∞—Å—Ç–∞–≤–∫—É –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏" –ù–∏–∫–æ–≥–¥–∞; "–í—ã–∫–ª—é—á–∞—Ç—å –¥–∏—Å–ø–ª–µ–π –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏" 3 —á–∞—Å–∞

   </p>
   </details>

   <details>
   <summary><strong>1.3) –î–æ–≤–µ—Ä–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º Keychain</strong></summary>
   <p>

üîó –°–≤—è–∑–∫–∞ –∫–ª—é—á–µ–π ‚Üí –°–∏—Å—Ç–µ–º–∞ ‚Üí –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã ‚Üí –ü–æ –æ—á–µ—Ä–µ–¥–∏ –¥–≤–∞–∂–¥—ã –∫–ª–∏–∫–∞–µ–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã <–∫–æ–º–ø–∞–Ω–∏–∏>* ‚Üí –î–æ–≤–µ—Ä–∏–µ: –í—Å–µ–≥–¥–∞ –¥–æ–≤–µ—Ä—è—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—É–Ω–∫—Ç–∞

üîó –°–≤—è–∑–∫–∞ –∫–ª—é—á–µ–π ‚Üí –í—Ö–æ–¥ ‚Üí –ú–æ–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã ‚Üí –î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –Ω–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Üí  –î–æ–≤–µ—Ä–∏–µ: –í—Å–µ–≥–¥–∞ –¥–æ–≤–µ—Ä—è—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—É–Ω–∫—Ç–∞

üîó –°–≤—è–∑–∫–∞ –∫–ª—é—á–µ–π ‚Üí –°–∏—Å—Ç–µ–º–∞ ‚Üí –ú–æ–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã ‚Üí –î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –Ω–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç MDMIdentity ‚Üí  –î–æ–≤–µ—Ä–∏–µ: –í—Å–µ–≥–¥–∞ –¥–æ–≤–µ—Ä—è—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—É–Ω–∫—Ç–∞

   </p>
   </details>

   <details>
   <summary><strong>1.4)–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —É—Ç–∏–ª–∏—Ç—ã/–Ω–∞—Å—Ç—Ä–æ–π–∫–∏</strong></summary>
   <p>

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ oh-my-zsh: `sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"`

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ brew: `/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"`

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ shellenv –≤ .zprofile: `(echo; echo 'eval "$(/opt/homebrew/bin/brew shellenv)"') >> ~/.zprofile`

–û–±–Ω–æ–≤–∏—Ç—å shell: `exec $SHELL -l`

–†–∞–∑—Ä–µ—à–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∏–∑ –ª—é–±–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞: `sudo spctl --master-disable`

–ú–µ–Ω—è–µ–º –ø—Ä–∞–≤–∞ –¥–ª—è local –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:
```bash
sudo chmod -R 775 /usr/local/*
sudo chown -R $(whoami):admin /usr/local/*
```

   </p>
   </details>


   <details>
   <summary><strong>1.5) –ù–∞—Å—Ç—Ä–æ–π–∫–∞ JAVA_HOME</strong></summary>
   <p>

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ java: 

```bash
brew install temurin
echo "export JAVA_HOME=$(/usr/libexec/java_home)" >> ~/.zshrc"
echo "PATH=$PATH:$JAVA_HOME/bin" >> ~/.zshrc
source ~/.zshrc
``` 

–ï—Å–ª–∏ –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏–ª–æ—Å—å, —Ç–æ `JAVA_HOME` –¥–æ–ª–∂–Ω–∞ –≤—ã–¥–∞–≤–∞—Ç—å –ø—É—Ç—å –∫ –±–∏–Ω–∞—Ä–Ω–∏–∫—É –¥–∂–∞–≤—ã: 
```bash
echo $JAVA_HOME
// output: /Library/Java/JavaVirtualMachines/adoptopenjdk-16.jdk/Contents/Home
```
   </p>
   </details>

</p>
</details>







----

<details>
<summary><strong>2) –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω—ã–π —ç—Ç–∞–ø</strong></summary>
<p>

    –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –¥–∞–Ω–Ω–æ–≥–æ —ç—Ç–∞–ø–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —É—Å–ø–µ—à–Ω–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞ –ú–ü

   <details>
   <summary><strong>2.1) TLS Handshake</strong></summary>
   <p>

–ù–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ ssl: openssl.cnf:

–ü–æ–º–µ–Ω—è—Ç—å –ø—Ä–∞–≤–∞ –¥–ª—è –≤—Å–µ—Ö –∫–æ–Ω—Ñ–∏–≥–æ–≤ `sudo chmod u+w /System/Library/OpenSSl/openssl.cnf` + `sudo chmod u+w /usr/local/etc/openssl@3`


–î–∞–ª–µ–µ `vim openssl.cnf`:
```ini
openssl_conf = default_conf
 
[ default_conf ]
ssl_conf = ssl_sect
 
[ssl_sect]
system_default = ssl_default_sect
 
[ssl_default_sect]
Options = UnsafeLegacyRenegotiation
```

–ó–¥–µ—Å—å –æ–±—Ä–∞—â–∞—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ —Å–∫–æ—Ä–µ–µ –Ω—É–∂–Ω–æ –Ω–∞ –ø—É–Ω–∫—Ç —Å UnsafeLegacyRenegotiation, –Ω–∞ –æ—Å—Ç–∞–ª—å–Ω–æ–µ –ø–æ—Ñ–∏–≥

`source ~/`

   </p>
   </details>

   <details>
   <summary><strong>2.2) –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ iOS –ø—Ä–æ–µ–∫—Ç–∞</strong></summary>
   <p>

–°–∫–∞—á–∞—Ç—å Xcode —Å —Å–∞–π—Ç–∞ https://xcodereleases.com/

–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ Xcode<–≤–µ—Ä—Å–∏—è>. –î–∞–ª–µ–µ Xcode16.3 –ø–µ—Ä–µ–Ω–æ—Å–∏–º –≤ "–ü—Ä–æ–≥—Ä–∞–º–º—ã"

–ü—Ä–æ–≤–µ—Ä–∏–º –µ—Å—Ç—å –ª–∏ Xcode –≤ Applications

`find /Applications -type d  -maxdepth 1 -name "Xcode*.app"`

xcode-select:

`sudo xcode-select --switch /Applications/Xcode16.3.app/Contents/Developer`

–í—Ö–æ–¥ –≤ —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ç–∞–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è, –∫–∞–∫ –æ—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞, –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ Xcode –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: `DevToolsSecurity -enable`

–ö–ª–æ–Ω–∏—Ä—É–µ–º iOS –ø—Ä–æ–µ–∫—Ç:

```bash
git config --global http.maxRequestBuffer 100M --depth=1
git clone https://YourProject.git NamingYourProject
git fetch --unshallow
git pull --all
```

–û—Ç–∫—Ä—ã–≤–∞–µ–º Xcode –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ —á—Ç–æ –Ω—É–∂–Ω–æ

   </p>
   </details>

   <details>
   <summary><strong>2.3) –£—Å—Ç–∞–Ω–æ–≤–∫–∞ iOS –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</strong></summary>
   <p>

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º xcodegen:

`brew install xcodegen`

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º cocoapods:

`brew install cocoapods`

–£–¥–∞–ª—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ http:

```bash
gem source -r https://rubygems.org/
gem source -a http://rubygems.org/
gem source --list
! –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Ä–º–∏–Ω–∞–ª
```

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º node:
```bash
brew install node`
 
# –µ—Å–ª–∏ `which node` –Ω–µ –≤—ã–¥–∞–µ—Ç `/usr/local/bin/node`:
sudo ln -s $(which node) /usr/local/bin/node
```

   </p>
   </details>

   <details>
   <summary><strong>2.4) –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥–æ–Ω</strong></summary>
   <p>

Locate Xcode:

`sudo xcode-select --switch /Applications/Xcode16.3.app/Contents/Developer`

React –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `npm i -g eas-cli`

–°–æ–±–∏—Ä–∞–µ–º –ø—Ä–æ–µ–∫—Ç: `./generate_all -o`

–í Xcode –≤—ã–±–∏—Ä–∞–µ–º YourProjectBeta –∏ –∑–∞–ø—É—Å–∫–∞–µ–º —Å–±–æ—Ä–∫—É. –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–∫–∂–µ —Ç–µ—Å—Ç—ã, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç.

   </p>
   </details>

</p>
</details>





---

<details>
<summary><strong>3) –ó–∞–ø—É—Å–∫ –∞–≥–µ–Ω—Ç–∞ Jenkins</strong></summary>
<p>

    –†–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π —ç—Ç–∞–ø –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–ª–µ–π–≤–∞ jenkins –∏ –ø–æ–¥–Ω—è—Ç–∏–µ –∞–≥–µ–Ω—Ç–∞

   <details>
   <summary><strong>3.1) –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ—Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ú–ü –ü—É–ª—å—Å–∞: sonar, fastlane</strong></summary>
   <p>

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Fastalne:

```bash
brew install fastlane
fastlane env
```

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Sonar Scanner:

```bash
brew install sonar
brew install sonar-scanner
```

–£—Å—Ç–∞–Ω–æ–≤–∏–≤ —Å–æ–Ω–∞—Ä —É –Ω–∞—Å –ø–æ—è–≤–∏—Ç—Å—è —Å—Å—ã–ª–∫–∞:
```bash
where sonar-scanner
// output: `/usr/local/bin/sonar-scanner` —Å—Å—ã–ª–∫–∞ –Ω–∞ -> `/usr/local/Cellar/sonar-scanner`
where sonar
// output: `/usr/local/bin/sonar`
```

–ó–∞—Ö–æ–¥–∏–º –∏ —Å–º–æ—Ç—Ä–∏–º –∫—É–¥–∞ –≤–µ–¥—É—Ç —Å—Å—ã–ª–∫–∏. –ú–µ–Ω—è–µ–º –ø—Ä–∞–≤–∞ —ç—Ç–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:

```
sudo chmod -R 775 /usr/local/Cellar/sonar-scanner
sudo chmod -R 775 /usr/local/Cellar/sonarqube
```

> –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–Ω–∞—Ä–∞
> 
> –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å–æ–Ω–∞—Ä–∞, –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–º–∞–Ω–¥—É `sonar-scanner`
> 
> –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
> ![](https://github.com/eldaroid/pictures/blob/master/iOSWiki/Frameworks/sonar-scenner.png?raw=true)



   </p>
   </details>

   <details>
   <summary><strong>3.2) –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Jenkins</strong></summary>
   <p>

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π:

`mkdir ~/jenkins; cd ~/jenkins; mkdir keystore;`

üîó –°–≤—è–∑–∫–∞ –∫–ª—é—á–µ–π ‚Üí –°–∏—Å—Ç–µ–º–∞ ‚Üí –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã ‚Üí –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∏–∑ keychain YourCompanyRootCA –∏ YourCompanyExternalCA –≤ `~/jenkins/keystore`

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ SonarCert:

`cd ~/jenkins/keystore; openssl s_client -connect sonarqube.ru:443 | openssl x509 -out sonar_ssl.cert`

   </p>
   </details>

   <details>
   <summary><strong>3.3) –î–æ–≤–µ—Ä–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º –¥–ª—è Java</strong></summary>
   <p>

–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è Java: `cd $JAVA_HOME/lib/security`

–î–æ–≤–µ—Ä–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º YourCompanyRootCA:

```bash
sudo ../../bin/keytool --import -trustcacerts -alias YourCompanyRootCA -file ~/jenkins/keystore/YourCompanyRootCA.cer -keystore ./cacerts -storepass changeit -noprompt
// output: Certificate was added to keystore
```

–î–æ–≤–µ—Ä–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º YourCompanyExternalCA:

```bash
sudo ../../bin/keytool --import -trustcacerts -alias YourCompanyExternalCA -file ~/jenkins/keystore/YourCompanyExternalCA.cer -keystore ./cacerts -storepass changeit -noprompt
// output: Certificate was added to keystore
```

–î–æ–≤–µ—Ä–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º SonarCert:

```bash
sudo ../../bin/keytool --import -trustcacerts -alias SonarCert -file ~/jenkins/keystore/sonar_ssl.cert -keystore ./cacerts -storepass changeit -noprompt
// output: Certificate was added to keystore
```

–°–ø–∏—Å–æ–∫ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–π –∫–æ—Ä–Ω–µ–≤—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤: `keytool -list -v -keystore $JAVA_HOME/lib/security/cacerts`

   </p>
   </details>

   <details>
   <summary><strong>3.4) –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ø–æ–¥–Ω—è—Ç–∏–µ Java CLI –∞–≥–µ–Ω—Ç–∞ Jenkins</strong></summary>
   <p>

–ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é jenkins: `cd ~/jenkins`

–°–∫–∞—á–∏–≤–∞–µ–º –∞–≥–µ–Ω—Ç jenkins:
```bash
echo insecure >> ~/.curlrc; source ~/.curlrc;
export HOMEBREW_CURLRC=1 // —á—Ç–æ–±—ã brew —Å–º–æ—Ç—Ä–µ–ª –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–Ω—Ñ–∏–≥ –ø–æ –ø—É—Ç–∏ ~/.curlrc
exec $SHELL
curl https://jenkinsAgent.ru/jnlpJars/agent.jar --output ~/jenkins/agent.jar
```

–¢–µ–ø–µ—Ä—å –ø–æ–¥–Ω–∏–º–µ–º —ç—Ç–æ—Ç –∞–≥–µ–Ω—Ç:
```bash
java -jar agent.jar -jnlpUrl https://jenkinsAgent.ru/computer/mac-mini-3/jenkins-agent.jnlp -secret 12341234 -workDir "/Users/eldarpopov/jenkins" -noCertificateCheck
```

–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –Ω–µ—É–¥–∞—á–Ω–æ–π —Å–±–æ—Ä–∫–∏ –ø–æ—è–≤–∏—Ç—Å—è –ø–∞–ø–∫–∞ workspace:
```bash
sudo chown -R $(whoami):admin ~/jenkins/workspace;
sudo chmod -R 775 /opt/homebrew/Cellar
```

   </p>
   </details>

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–ø—É—Å–∫–∞ —Å–±–æ—Ä–∫–∏ –∫–∞–∫ –≤ –¥–∂–µ–Ω–∫–∏–Ω—Å–µ: `ci/build.sh beta none myApp`

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ —Å–æ–Ω–∞—Ä–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–º–∞–Ω–¥—É: `sh ci/sonarqube_scan.sh tech/popov/justForCI develop 8482 0`

</p>
</details>






---

<details>
<summary><strong>4) –ê—Ä—Ö–∏–≤–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏/–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–≤–∏–∂–µ–Ω–æ–≤</strong></summary>
<p>

–¢–∏–ø —Å–±–æ—Ä–∫–∏ - —Ç–∞—Ä–≥–µ—Ç —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –¥–µ–ª–∞–µ—Ç—Å—è —Å–±–æ—Ä–∫–∞:
* beta - –±–µ—Ç–∞ —Å–±–æ—Ä–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è;
* inhouse - —Ä–µ–ª–∏–∑–Ω–∞—è —Å–±–æ—Ä–∫–∞ –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏;
* ipadinhouse - —Ä–µ–ª–∏–∑–Ω–∞—è —Å–ø–µ—Ü. ipad –≤–µ—Ä—Å–∏–∏ —Å–±–æ—Ä–∫–∞ –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏;
* ipadbeta - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü. ipad –≤–µ—Ä—Å–∏–∏;


> –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–≤–∏–∂–µ–Ω–æ–≤ –¥–ª—è –¥–µ–π–ª–∏ –∏ —Ä–µ–ª–∏–∑ —Å–±–æ—Ä–æ–∫

   <details>
   <summary><strong>4.1) Iphone Beta —Å–±–æ—Ä–∫–∞</strong></summary>
   <p>

1. –í–æ–π—Ç–∏ –≤ —Ä–∞–±–æ—Ç–∞—é—â—É—é —Å–±–æ—Ä–æ—á–Ω—É—é –º–∞—à–∏–Ω—É (–Ω/—Ä: mac-mini-1)
2. –û—Ç–∫—Ä—ã—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å —Ä–µ–ø–æ–π `~/jenkins/workspace/YourApp/CI123123/ios`
3. –ó–∞–ø—É—Å—Ç–∏—Ç—å `./generate_all.sh -o`
4. –í—ã–±—Ä–∞—Ç—å —Ç–∞—Ä–≥–µ—Ç `YourAppBeta` –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–ª—è —Å–±–æ—Ä–∫–∏ any iOS device: ![](https://github.com/eldaroid/pictures/blob/master/iOSWiki/Frameworks/formBeta.png?raw=true)
5. –í —Ç–∞—Ä–≥–µ—Ç–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤—ã–±—Ä–∞—Ç—å `sign & capabiilities` –≤—ã–±—Ä–∞—Ç—å –ø—Ä–æ–≤–∏–∂–µ–Ω –∏–∑ –∫–æ—Ä–Ω—è —Ä–µ–ø—ã `YourApp_Beta_Distrib.mobileprovision`
6. –î–æ–±–∞–≤–∏—Ç—å –∫–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–û–û–û "–í–∞—à–∞ –∫–æ–º–ø–∞–Ω–∏—è"). Launchpad - Kaystore - –°–∏—Å—Ç–µ–º–∞ - –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å–µ—Ä—Ç "–û–û–û ..." –≤ –º–æ–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã. –î–∞—Ç—å –¥–æ–≤–µ—Ä–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—É
7. –í Xcode –≤ sign & capabiilities –¥–æ–ª–∂–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–æ–º –ø–æ–¥—Ç—è–Ω—É—Ç—Å—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç `"Rapair with ... OOO"`
8. Product -> Archive

   </p>
   </details>

   <details>
   <summary><strong>4.2) Iphone In-house —Å–±–æ—Ä–∫–∞</strong></summary>
   <p>

iOSWiki/Frameworks/formInhouse.png

1. –í–æ–π—Ç–∏ –≤ —Ä–∞–±–æ—Ç–∞—é—â—É—é —Å–±–æ—Ä–æ—á–Ω—É—é –º–∞—à–∏–Ω—É (–Ω/—Ä: mac-mini-1)
2. –û—Ç–∫—Ä—ã—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å —Ä–µ–ø–æ–π `~/jenkins/workspace/YourApp/CI123123/ios`
3. –ó–∞–ø—É—Å—Ç–∏—Ç—å `./generate_all.sh -o`
4. –í—ã–±—Ä–∞—Ç—å —Ç–∞—Ä–≥–µ—Ç `YourApp` –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–ª—è —Å–±–æ—Ä–∫–∏ any iOS device: ![](https://github.com/eldaroid/pictures/blob/master/iOSWiki/Frameworks/formInhouse2.png?raw=true)
5. –í —Ç–∞—Ä–≥–µ—Ç–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤—ã–±—Ä–∞—Ç—å `sign & capabiilities` –≤—ã–±—Ä–∞—Ç—å –ø—Ä–æ–≤–∏–∂–µ–Ω –∏–∑ –∫–æ—Ä–Ω—è —Ä–µ–ø—ã `YourApp_Distrib.mobileprovision`
6. –î–æ–±–∞–≤–∏—Ç—å –∫–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–û–û–û "–í–∞—à–∞ –∫–æ–º–ø–∞–Ω–∏—è"). Launchpad - Kaystore - –°–∏—Å—Ç–µ–º–∞ - –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å–µ—Ä—Ç "–û–û–û ..." –≤ –º–æ–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã. –î–∞—Ç—å –¥–æ–≤–µ—Ä–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—É
7. –í Xcode –≤ sign & capabiilities –¥–æ–ª–∂–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–æ–º –ø–æ–¥—Ç—è–Ω—É—Ç—Å—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç `"Rapair with ... OOO"`
8. Product -> Archive

   </p>
   </details>

</p>
</details>




---

<details>
<summary><strong>ü§ß –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã</strong></summary>
<p>

   <details>
   <summary><strong>5.1) Xcode</strong></summary>
   <p>

–°–ø–∏—Å–æ–∫ –æ—à–∏–±–æ–∫ –∏ —Ä–µ—à–µ–Ω–∏–π –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –ø–æ [—Å—Å—ã–ª–∫–µ](https://github.com/eldaroid/iOSWiki/blob/master/1%20Common/1.1%20Configs/1.1.6%20Xcode/1.1.6.1%20XcodeSetting.md#–æ—à–∏–±–∫–∞-1-—Å—Ç–∞—Ä–∞—è-–≤–µ—Ä—Å–∏—è)

   </p>
   </details>


   <details>
   <summary><strong>5.2) jarfile agent.jar</strong></summary>
   <p>



   <details>
   <summary><strong>5.2.1) Failed to connect to https://YourProject.ru/. Will try again. JnlpAgentEndpointResolver</strong></summary>
   <p>

![ErrorJnlpAgentEndpointResolver](https://github.com/eldaroid/pictures/blob/master/iOSWiki/Frameworks/ErrorJnlpAgentEndpointResolver2.png?raw=true)

–†–µ—à–µ–Ω–∏–µ: –ø—Ä–æ–±–ª–µ–º–∞ —Å Wi-fi

   </p>
   </details>
   
   <details>
   <summary><strong>5.2.2) Error: invalid or courrupt jarfile agent.jar</strong></summary>
   <p>

–í–æ –≤—Ä–µ–º—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª agent.jar —É—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π –∏–ª–∏ –±–µ–∑ TLS handshake. –°–∫–∞—á–∞—Ç—å –∞–≥–µ–Ω—Ç –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ.

   </p>
   </details>

   </p>
   </details>

   <details>
   <summary><strong>5.3) iOS –£—Ç–∏–ª–∏—Ç—ã: cocoapods, fastlane, node</strong></summary>
   <p>

   <details>
   <summary><strong>5.3.1) Cocoapods: Ingore ffi-1.15.5 because its extensions are not built</strong></summary>
   <p>

–†–µ—à–µ–Ω–∏–µ:
```bash
brew uninstall --force cocoapods
brew uninstall --ignore-dependencies ruby
brew install cocoapods
```

   </p>
   </details>

   <details>
   <summary><strong>5.3.2) Could not find node</strong></summary>
   <p>

[Error] Could not find node. It looks like that the .xcode.env or .xcode.env.local 

Command PhaseScriptExecution failed with a nonzero exit code

–†–µ—à–µ–Ω–∏–µ: `sudo ln -s $(which node) /usr/local/bin/node`

   </p>
   </details>

   </p>
   </details>
</p>
</details>



---

[4.4.1 CI/CD Theme](/4%20Linkage/4.4%20CI:CD/4.4.1%20CI:CD.md) | [Back To iOSWiki Contents](https://github.com/eldaroid/iOSWiki) | [4.4.3 Android CI/CD Guide Theme](/4%20Linkage/4.4%20CI:CD/4.4.3%20ü§ñ%20Android_CI.md)